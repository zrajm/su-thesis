%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Template for Bachelor's, Magister and Master's theses at the Department of
%% Linguistics, Stockholm University
%%
%% Modelled on Studentuppsatsmall at https://www.su.se/biblioteket/
%%
%% Version 1.2 by zrajm, 23 February 2020
%% Version 1.1 by zrajm, 22 February 2020
%% Version 1 by Mats Wirén, 12 February 2020
%% Version by Adam Ek & Elena Moser, 19 February 2019
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Projektstruktur
%% /
%% ├── su-template.sty
%% └── /media/
%%     ├── su-logga-sv.png
%%     └── su-logo-en.png
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Denna uppsatsmall inkluderar:
%%
%%   * Titelsida
%%   * Sida med abstract/sammanfattning
%%   * Innehållsförteckning
%%   * Baksida
%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%
%% OBS: I Overleaf, byt kompilator till XeLaTeX
%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Configuration
%%
%% To use this template, first set a babel language, then load this package,
%% then set all the relevant values. Like this:
%%
%%     \usepackage[swedish]{babel} % Swedish
%%     \usepackage[UKenglish]{babel} % British English
%%     \usepackage[USenglish]{babel} % American English
%%
%%     \usepackage{su-template}
%%
%%     %% Always used
%%     \suset{author}{Förnamn Efternamn}
%%     \suset{supervisor}{Förnamn1 Efternamn1[, Förnamn2 Efternamn2]}
%%     \suset[swedish]{title}{Titel på svenska}
%%     \suset[english]{title}{Title in English}
%%     \suset[swedish]{abstract}{Sammanfattning på svenska}
%%     \suset[english]{abstract}{Abstract in English}
%%     %% Swedish metadata (only used if language is Swedish)
%%     \suset[swedish]{subtitle}{Svensk undertitel}
%%     \suset[swedish]{keywords}{nyckelord1, nyckelord2, nyckelord3, \ldots}
%%     \suset[swedish]{department}{Institutionen för lingvistik}
%%     \suset[swedish]{thesistype}{Examensarbete 15 hp}
%%     \suset[swedish]{course}{Lingvistik -- kandidatkurs, LIN600}
%%     \suset[swedish]{program}{Kandidatprogrammet i lingvistik 180 hp}
%%     \suset[swedish]{semester}{Vårterminen 2020}
%%     %% English metadata (only used if language is English)
%%     \suset[english]{subtitle}{English Subtitle}
%%     \suset[english]{keywords}{keyword1, keyword2, keyword3, \ldots}
%%     \suset[english]{department}{Department of Linguistics}
%%     \suset[english]{thesistype}{Bachelor's Thesis 15 ECTS credits}
%%     \suset[english]{course}{Linguistics -- Bachelor's Course, LIN600}
%%     \suset[english]{program}{Bachelor's Programme in Linguistics 180 ECTS credits}
%%     \suset[english]{semester}{Spring semester 2020}
%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Support for Swedish characters (and other Unicode characters).
%% [https://tex.stackexchange.com/questions/664/]
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Use " for quotes. [https://tex.stackexchange.com/questions/386695/]
%%
%% The csquotes package also allows for language-sensitive quotes, and quotes
%% inside quotes etc. For full specs see csquotes docs:
%% http://ftp.acc.umu.se/mirror/CTAN/macros/latex/contrib/csquotes/csquotes.pdf
\usepackage[autostyle=true]{csquotes}
\MakeOuterQuote{"}

%% Needed for \IfSubStr.
\usepackage{xstring}

%% \usepackage{showframe} % DEBUG: displays margin


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Slew of random stuff

\usepackage{xcolor}
\definecolor{Blue}{rgb}{0,0.1843,0.3725}

%% http://mirrors.ctan.org/macros/latex/contrib/geometry/geometry.pdf
\usepackage[paper=a4paper,left=25mm,right=25mm,top=25mm,bottom=25mm]{geometry}

\usepackage{graphicx}
\usepackage{url}
\usepackage{hyperref}

%% Title page:
%%   * title = size:28pt / lead:28pt(?)
%%   * subtitle + auth name size:14pt / lead:20pt or 24pt / (above:6pt / below:28pt)
%%

\renewcommand\Huge{\@setfontsize\Large{28pt}{34pt}}   % front page title
\renewcommand\large{\@setfontsize\large{14pt}{24pt}}  % front page subtitle
\renewcommand\small{\@setfontsize\large{8pt}{11.6pt}} % front/back page text

%% http://ftp.acc.umu.se/mirror/CTAN/macros/latex/contrib/fontspec/fontspec.pdf
\usepackage{fontspec}
\setmainfont[Ligatures=TeX]{Times New Roman}
\setsansfont[Ligatures=TeX,WordSpace=.95,LetterSpace=1]{Verdana}

% \setmainfont{Doulos SIL} % contains IPA (see https://software.sil.org/doulos/)
% \setmainfont{Linux Libertine O} % contains IPA

%\usepackage{libertine}
%\usepackage{libertinust1math}
%\setmonofont[Scale=0.76]{Bitstream Vera Sans Mono} % typewriter font and scaling

\usepackage{titlesec}

\definecolor{SUBlue}{rgb}{.204,.353,.541}
% Define a new fontfamily for the subsubsection font
% Don't use \fontspec directly to change the font
%\newfontfamily\sectionfont[Color=SUBlue]{Verdana}
\newfontfamily\sectionfont{Verdana}
%% % Set formats for each heading level
%% \titleformat*{\section}{\Large\sectionfont\color{MSBlue}}
%% \titleformat*{\subsection}{\large\bfseries\sffamily\color{MSLightBlue}}
%% %\titleformat*{\subsubsection}{\itshape}

\titleformat*{\section}{\Huge\sectionfont}
\titleformat*{\subsection}{\Large\bfseries\sectionfont}
\titleformat*{\subsubsection}{\bfseries\sectionfont}
%% \titleformat*{\paragraph}{\large\bfseries}
%% \titleformat*{\subparagraph}{\large\bfseries}


%% % Define a new fontfamily for the subsubsection font
%% % Don't use \fontspec directly to change the font
%% \newfontfamily\sectionfont{Verdana}
%% % Set formats for each heading level
%% \titleformat*{\section}{\Large\bfseries\sffamily}
%% %\titleformat*{\section}{\subsubsectionfont}
%% %% \titleformat*{\subsection}{\subsubsectionfont}
%% %% \titleformat*{\subsubsection}{\subsubsectionfont}


\usepackage{amsmath}
\usepackage{tabularx}
% \usepackage[capitalize,noabbrev]{cleveref}
% \usepackage[capitalize,noabbrev]{cleveref}

% Create normal/logarithmic plots in two and three dimensions
% \usepackage{pgfplots}

% \usepackage{filecontents}
\usepackage[title]{appendix}

% Define footnotecolor
\makeatletter
\def\@footnotecolor{red}
\define@key{Hyp}{footnotecolor}{%
 \HyColor@HyperrefColor{#1}\@footnotecolor%
}
\def\@footnotemark{
    \leavevmode
    \ifhmode\edef\@x@sf{\the\spacefactor}\nobreak\fi
    \stepcounter{Hfootnote}%
    \global\let\Hy@saved@currentHref\@currentHref
    \hyper@makecurrent{Hfootnote}%
    \global\let\Hy@footnote@currentHref\@currentHref
    \global\let\@currentHref\Hy@saved@currentHref
    \hyper@linkstart{footnote}{\Hy@footnote@currentHref}%
    \@makefnmark
    \hyper@linkend
    \ifhmode\spacefactor\@x@sf\fi
    \relax
  }
\makeatother

\usepackage{hyperref}
\hypersetup{
  colorlinks=true, % hyperlinks will be coloured
  linkcolor=blue, % hyperlink text will be blue
  citecolor=red, % citation year will be red
  footnotecolor=black, % footnotes will be black
  % linkbordercolor=red % hyperlink border will be red
  }
% Hyperlänkar för citeringar omfattar bara år. Ska tydligen vara så: https://latex.org/forum/viewtopic.php?t=25341

% Examples & Glossaries
%\usepackage{expex} % for examples
%\usepackage{glossaries}

\usepackage{tikz}
\usetikzlibrary{shapes.geometric, arrows, positioning}

\usepackage{soulutf8} % Highlighting with \hl{} and utf-8

\usepackage{multirow}

\usepackage{etoolbox}

%% Commands which set/get variables named \su<LANG><NAME>.
\newcommand{\suset}[3][english]{\csdef{su#1#2}{#3}}
\newcommand{\suget}[2][english]{%
  \ifcsdef{su#1#2}{%
    \csuse{su#1#2}%
  }{%
    \hl{Add \texttt{\textbackslash{}suset[#1]\{#2\}\{...\}}}%
  }%
}

\newcommand{\susubtitle}[2][english]{
  \ifcsdef{su#1#2}{%
    \vspace{10pt}

    \noindent{\large\suget[#1]{#2}\par}%
  }{}
}

\newcommand{\sumakefrontpage}{%
  {%
    \color{Blue}%
    \sffamily

    \noindent{%
      \raggedright%
      \Huge%
      \iflanguage{swedish}{%
        \suget[swedish]{title}%
      }{%
        \suget[english]{title}%
      }%
      \par%
    }

    \iflanguage{swedish}{%
      \susubtitle[swedish]{subtitle}%
    }{%
      \susubtitle[english]{subtitle}%
    }

    \vspace{38pt}

    \noindent{%
      \large%
      \suget{author}%
    }

    \vspace{\fill}

    \begin{small}
      \noindent
      \iflanguage{swedish}{%
        \suget[swedish]{department} \\
        \suget[swedish]{thesistype} \\
        \suget[swedish]{course} \\
        \suget[swedish]{program} \\
        \suget[swedish]{semester} \\
        Handledare: \suget{supervisor} \\
        English title: \suget[english]{title}
      }{%
        \suget[english]{department} \\
        \suget[english]{thesistype} \\
        \suget[english]{course} \\
        \suget[english]{program} \\
        \suget[english]{semester} \\
        Supervisor\IfSubStr{\suenglishsupervisor}{,}{s}{}: \suget{supervisor} \\
        Swedish title: \suget[swedish]{title}
      }
    \end{small}

    \vspace{-2.5em}%

    \hspace{\stretch 1}\ \kern\textwidth\kern-50mm\smash{%
      \raisebox{-3mm}{%
        \iflanguage{swedish}{%
          \includegraphics[width=41mm]{./media/su-logga-sv.png}%
        }{%
          \includegraphics[width=41mm]{./media/su-logo-en.png}%
        }%
      }%
    }
    %\renewcommand{\contentsname}{Table of Contents} % Uncomment to change the title of table of contents page to what is written in {Table of Contents}.
    \pagenumbering{gobble} % Switch off page numbering in table of contents
  }%
}

\newcommand{\sumakeabstractpage}{
  \noindent
  {\LARGE\sectionfont\iflanguage{swedish}{\suget[swedish]{title}}{\suget[english]{title}}}

  \vspace*{2em}

  \noindent
  {\large\suget{author}}

  \vspace*{3em}

  \iflanguage{swedish}{%
    \section*{Sammanfattning}
    \suget[swedish]{abstract}
    \subsection*{Nyckelord}
    \suget[swedish]{keywords}

    \section*{Abstract}
    \suget[english]{abstract}
    \subsection*{Keywords}
    \suget[english]{keywords}
  }{%
    \section*{Abstract}
    \suget[english]{abstract}
    \subsection*{Keywords}
    \suget[english]{keywords}

    \section*{Sammanfattning}
    \suget[swedish]{abstract}
    \subsection*{Nyckelord}
    \suget[swedish]{keywords}
  }
}

\newcommand{\sumakebackpage}{%
  {%
    \color{Blue}%
    \sffamily

    \vspace*{\fill}

    \begin{small}
      \noindent
      \iflanguage{swedish}{%
        Stockholms universitet \\
        106\,91 Stockholm \\
        Telefon 08-16\,20\,00 \\
        \texttt{https://www.su.se/}
      }{%
        Stockholm University \\
        SE-106\,91 Stockholm, Sweden \\
        Telephone +46 (0)8\,16\,20\,00 \\
        \texttt{https://www.su.se/}
      }
    \end{small}

    \vspace*{-1em}

    \hspace{\stretch 1}\ \kern\textwidth\kern-50mm\smash{%
      \raisebox{-3mm}{%
        \iflanguage{swedish}{%
          \includegraphics[width=41mm]{./media/su-logga-sv.png}%
        }{%
          \includegraphics[width=41mm]{./media/su-logo-en.png}%
        }%
      }%
    }%
  }%
}

\AtBeginDocument{
  \sumakefrontpage
  \clearpage

  \sumakeabstractpage
  \clearpage

  \tableofcontents
  \clearpage

  \pagenumbering{arabic} % start page numbering
}

\AtEndDocument{
  \pagenumbering{gobble} % turn off page numbering
  \sumakebackpage
  \clearpage
}

%% [eof]
